<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Diem cognosce</title>
<!-- Versions M2021-01-09 Adapt to new architecture

	M2019-07-27 
	M2020-04-12 Simplify !DOCTYPE
	M2020-04-16 Set head section in line with present recommendations
-->
	<meta name="creator" content="Louis-Aimé de Fouquières">
	<meta name="description" content="This clock displays	 the day of the tropical year, using the Milesian calendar">
	<meta name="keywords" content="Milesian clock, season's clock">
	<meta name="viewport" content="width=device-width">

	<link href="dialsandpanels.css" rel="stylesheet"/>
	<script type="text/javascript" src="chronos.js"></script>
	<script type="text/javascript" src="dateextended.js"></script>
	<script type="text/javascript" src="calendars.js"></script>
	<script type="text/javascript" src="calendarclock.js"></script>
	<script type="text/javascript">
	var lightClock = {
		timeOutId1 : null,					// Tick generator identifier
		lightMilesian : null,
		clockDial : null,
		targetDate : null
		}
	function setLightClockToNow() {	// Set clock to present date and time
		lightClock.targetDate = new ExtDate(lightClock.lightMilesian); // targeDate is today and now.	
		lightClock.clockDial.setHands (lightClock.targetDate.year(), lightClock.targetDate.month(), lightClock.targetDate.day(),
			lightClock.targetDate.getHours(), lightClock.targetDate.getMinutes(), lightClock.targetDate.getSeconds() ); // Display date on clock.
	}
	function setLightClockTicks() { // To be inserted on load of the clock
		lightClock.lightMilesian = new MilesianCalendar ("milesianclock");
		lightClock.clockDial = new SolarClock (document.querySelector("#clock1")); // Construct clock object, after HTML clock elements are identified.
		setLightClockToNow();		// Initial setting
		// lightClock.clockDial.setSeasons (lightClock.targetDate.year());	// Compute seasons at initialisation only.
		lightClock.timeOutId1 = window.setInterval(setLightClockToNow , 20000);	// Update every 20 s	
	}
	</script>
</head>

<body>
<div class="centered">	
<svg width="100%" height="100%" onload="JavaScript:setLightClockTicks()"
viewBox="-300 -300 600 600" preserveAspectRatio="xMidYMid meet"
xmlns="http://www.w3.org/2000/svg" 
xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="clock1">
<!-- the dial -->
<image href="Milesian_dial_2936.png" x="-300" y ="-300" width="600" height="599"/>
<!-- the motto on the dial -->
<text class="motto" x="0" y="36" >CERTUM MONSTRAT DIEM</text>
<!-- main dial: month, day; the rect enables to fetch the center of the dial -->
<rect class="center month day" x="0" y="0" width="0" height="0"/>
<!-- the year field -->
  <text class="clock yeardisplay"
	x="0" y="+100"></text>
<!-- no seasons' mark -->
<!-- center circle -->
<circle class="clockhand" r="9" />
<!-- set the secondary time dial which sould appear under the month-day hands -->
<!-- Hour clock centered at x=0, y=-80 -->
  <g class="timeDial"> <!-- set a container for the time dial -->
	<circle cx="0" cy="-80" r="60" fill="none" stroke="black" />
	<rect class="center hour minute second" x="0" y="-80" width="0" height="0"/> <!-- center of the time dial -->
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(30,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(60,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(90,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(120,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(150,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(180,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(210,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(240,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(270,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(300,0,-80)"/>
	<line x1="0" x2="0" y1="-133" y2="-140" stroke="black" stroke-width="6px" transform="rotate(330,0,-80)"/>
  </g>
<!-- am/pm indicator -->
  <text class="clock ampm" 
	x="0" y="-50">am</text>
<!-- hours and minutes hands -->
  <g class="clockhand hour" transform="rotate(0)">
    <line x1="0" x2="0" y1="-80" y2="-120" />
  </g>
  <g class="clockhand minute" transform="rotate(0)">
    <line x1="0" x2="0" y1="-80" y2="-135" />
  </g>
<!-- month and day hands are set at the end, in order to be above the rest of the clock -->
<!-- the month hand -->
  <g class="clockhand month" transform="rotate(0)"
  opacity="0.8">										
	<polygon points="0,0 12,-20 10,-135 0,-145 -10,-135 -12,-20" />
  </g>
<!-- the day hand -->
  <g class="clockhand day" transform="rotate(0)"
  opacity="0.8" >									
	<polygon points="0,0 11,-20 8,-190 0,-200 -8,-190 -11,-20" />
  </g>
</g>
</svg>
</div>
</body>
</html>